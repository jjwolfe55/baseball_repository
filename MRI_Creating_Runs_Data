INSERT INTO mri_creating_batting_raw (
player_id,
player_name,
team_id,
season_id,
age,
bat,
primary_pos,
b_g,
b_pa,
b_1b,
b_2b,
b_3b,
b_hr,
b_bb,
b_ibb,
b_hbp,
mri_batting_raw
)
SELECT a.player_id,
a.player_name,
a.team_id,
a.season_id,
a.age,
a.bat,
a.primary_pos,
a.b_g,
a.b_pa,
((a.b_s*b.1b)*(c.run_adj)),
((a.b_d*b.2b)*(c.run_adj)),
((a.b_t*b.3b)*(c.run_adj)),
((a.b_hr*b.hr)*(c.run_adj)),
((a.b_bb*b.bb)*(c.run_adj)),
((a.b_ibb*b.ibb)*(c.run_adj)),
((a.b_hbp*b.hbp)*(c.run_adj)),
(((a.b_s*b.1b)*(c.run_adj))+
((a.b_d*b.2b)*(c.run_adj))+
((a.b_t*b.3b)*(c.run_adj))+
((a.b_hr*b.hr)*(c.run_adj))+
((a.b_bb*b.bb)*(c.run_adj))+
((a.b_ibb*b.ibb)*(c.run_adj))+
((a.b_hbp*b.hbp)*(c.run_adj)))
FROM standard_batting AS a
INNER JOIN standard_linear_weights AS b
ON a.season_id = b.season_id
INNER JOIN standard_run_environment AS c
ON a.team_id = c.team_id AND a.season_id = c.season_id
GROUP BY a.player_id,a.team_id,a.season_id;

INSERT INTO mri_creating_baserunning_raw (
player_id,
player_name,
team_id,
season_id,
age,
bat,
primary_pos,
b_sb,
b_cs,
mri_c_baserunning_raw
)
SELECT a.player_id,
a.player_name,
a.team_id,
a.season_id,
a.age,
a.bat,
a.primary_pos,
((a.b_sb*b.sb)*(c.run_adj)),
((a.b_cs*b.cs)*(c.run_adj)),
(((a.b_sb*b.sb)*(c.run_adj))+
((a.b_cs*b.cs)*(c.run_adj)))
FROM standard_batting AS a
INNER JOIN standard_linear_weights AS b
ON a.season_id = b.season_id
INNER JOIN standard_run_environment AS c
ON a.team_id = c.team_id AND a.season_id = c.season_id
GROUP BY a.player_id,a.team_id,a.season_id;

INSERT INTO mri_calc_creating_runs (
season_id,
total_mri_batting_raw,
total_mri_c_baserunning_raw,
total_mri_creating_raw,
total_earned_runs,
mri_creating_runs_adj)
SELECT a.season_id,
a.total_mri_batting_raw,
b.total_mri_c_baserunning_raw,
a.total_mri_batting_raw + b.total_mri_c_baserunning_raw,
c.total_earned_runs,
((c.total_earned_runs)/(a.total_mri_batting_raw + b.total_mri_c_baserunning_raw))
FROM (SELECT season_id, SUM(mri_batting_raw) AS total_mri_batting_raw
FROM mri_creating_batting_raw GROUP BY season_id) AS a
INNER JOIN (SELECT season_id, SUM(mri_c_baserunning_raw) AS total_mri_c_baserunning_raw
FROM mri_creating_baserunning_raw GROUP BY season_id) AS b
ON a.season_id = b.season_id
INNER JOIN (SELECT season_id, SUM(p_er) AS total_earned_runs
FROM standard_pitching GROUP BY season_id) AS c
ON a.season_id = c.season_id
GROUP BY a.season_id
ORDER BY a.season_id DESC;

INSERT INTO mri_creating_batting_runs (
player_id,
player_name,
team_id,
season_id,
age,
bat,
primary_pos,
mri_batting_rc,
mri_batting_avg)
SELECT a.player_id,
a.player_name,
a.team_id,
a.season_id,
a.age,
a.bat,
a.primary_pos,
a.mri_batting_raw*b.mri_creating_runs_adj,
(a.mri_batting_raw*b.mri_creating_runs_adj)/c.b_pa
FROM mri_creating_batting_raw AS a
INNER JOIN mri_calc_creating_runs AS b
ON a.season_id = b.season_id
INNER JOIN standard_batting AS c
ON a.player_id = c.player_id AND a.team_id = c.team_id AND a.season_id = c.season_id
GROUP BY a.player_id,a.team_id,a.season_id;

INSERT INTO mri_creating_baserunning_runs (
player_id,
player_name,
team_id,
season_id,
age,
bat,
primary_pos,
mri_c_baserunning_rc,
mri_c_baserunning_avg)
SELECT a.player_id,
a.player_name,
a.team_id,
a.season_id,
a.age,
a.bat,
a.primary_pos,
a.mri_c_baserunning_raw*b.mri_creating_runs_adj,
(a.mri_c_baserunning_raw*b.mri_creating_runs_adj)/(c.b_sb+c.b_cs)
FROM mri_creating_baserunning_raw AS a
INNER JOIN mri_calc_creating_runs AS b
ON a.season_id = b.season_id
INNER JOIN standard_batting AS c
ON a.player_id = c.player_id AND a.team_id = c.team_id AND a.season_id = c.season_id
GROUP BY a.player_id,a.team_id,a.season_id;
